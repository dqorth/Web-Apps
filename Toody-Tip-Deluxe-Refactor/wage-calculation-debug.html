<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wage Calculation Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            background-color: #d32f2f;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .test-button:hover {
            background-color: #b71c1c;
        }
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: #e3f2fd;
            color: #1565c0;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üêõ Wage Calculation Debug Test</h1>
        <p>Testing the wage calculation issue where 6.33 hrs √ó $15/hr = $94.95 but shows $95.00</p>
        
        <h3>Test Scenarios:</h3>
        <button class="test-button" onclick="testWageCalculation()">üî¨ Test Wage Calculation</button>
        <button class="test-button" onclick="testTimeCalculations()">‚è∞ Test Time Calculations</button>
        
        <div id="results"></div>
    </div>

    <script>
        // Import the time calculation functions (simulated)
        function timeToMinutes(tStr) {
            if (!tStr || typeof tStr !== 'string' || !tStr.includes(':')) return 0;
            const parts = tStr.split(':');
            if (parts.length !== 2) return 0;
            const h = parseInt(parts[0], 10);
            const m = parseInt(parts[1], 10);
            if (isNaN(h) || isNaN(m)) return 0;
            return h * 60 + m;
        }

        function calculateHoursWorked(tiStr, toStr) {
            if (!tiStr || !toStr) return 0;
            const mi = timeToMinutes(tiStr);
            const mo = timeToMinutes(toStr);
            if (mo <= mi) return 0; 
            return (mo - mi) / 60;
        }

        function testWageCalculation() {
            const results = document.getElementById('results');
            let output = "=== WAGE CALCULATION DEBUG ===\n\n";
            
            // Test the specific case reported by user
            const scenarios = [
                { timeIn: "09:00", timeOut: "15:20", payRate: 15, name: "6.33 hrs scenario (9:00-15:20)" },
                { timeIn: "09:00", timeOut: "15:19", payRate: 15, name: "6.32 hrs scenario (9:00-15:19)" },
                { timeIn: "09:00", timeOut: "15:21", payRate: 15, name: "6.35 hrs scenario (9:00-15:21)" },
                { timeIn: "10:00", timeOut: "16:20", payRate: 15, name: "Another 6.33 hrs (10:00-16:20)" }
            ];
            
            scenarios.forEach(scenario => {
                const hours = calculateHoursWorked(scenario.timeIn, scenario.timeOut);
                const wage = hours * scenario.payRate;
                const expectedWage = Math.round(hours * 100) / 100 * scenario.payRate; // Manual calculation
                
                output += `${scenario.name}:\n`;
                output += `  Time In: ${scenario.timeIn}\n`;
                output += `  Time Out: ${scenario.timeOut}\n`;
                output += `  Hours Calculated: ${hours}\n`;
                output += `  Hours Rounded to 2 decimals: ${Math.round(hours * 100) / 100}\n`;
                output += `  Pay Rate: $${scenario.payRate}/hr\n`;
                output += `  Wage (raw): $${wage}\n`;
                output += `  Wage (manual calc): $${expectedWage}\n`;
                output += `  Minutes worked: ${timeToMinutes(scenario.timeOut) - timeToMinutes(scenario.timeIn)}\n`;
                output += `  Exact decimal hours: ${(timeToMinutes(scenario.timeOut) - timeToMinutes(scenario.timeIn)) / 60}\n`;
                output += "\n";
            });
            
            // Test what gives exactly $95.00
            output += "=== REVERSE ENGINEERING $95.00 ===\n";
            const targetWage = 95.00;
            const payRate = 15;
            const requiredHours = targetWage / payRate;
            output += `To get exactly $95.00 at $15/hr, you need: ${requiredHours} hours\n`;
            output += `That's ${requiredHours * 60} minutes\n`;
            output += `Which is ${Math.floor(requiredHours)} hours and ${(requiredHours % 1) * 60} minutes\n\n`;
            
            results.innerHTML = `<div class="result">${output}</div>`;
        }

        function testTimeCalculations() {
            const results = document.getElementById('results');
            let output = "=== TIME CALCULATION PRECISION TEST ===\n\n";
            
            // Test various time combinations that might give 6.33 hours
            const timeCombos = [
                { timeIn: "09:00", timeOut: "15:20" }, // 380 minutes = 6.333... hours
                { timeIn: "08:00", timeOut: "14:20" },
                { timeIn: "10:00", timeOut: "16:20" },
                { timeIn: "11:00", timeOut: "17:20" },
                { timeIn: "09:30", timeOut: "15:50" },
                { timeIn: "09:00", timeOut: "15:19" }, // 379 minutes
                { timeIn: "09:00", timeOut: "15:21" }, // 381 minutes
            ];
            
            timeCombos.forEach(combo => {
                const hours = calculateHoursWorked(combo.timeIn, combo.timeOut);
                const minutes = timeToMinutes(combo.timeOut) - timeToMinutes(combo.timeIn);
                const wage = hours * 15;
                
                output += `${combo.timeIn} to ${combo.timeOut}:\n`;
                output += `  Minutes: ${minutes}\n`;
                output += `  Hours: ${hours}\n`;
                output += `  Precise hours: ${minutes / 60}\n`;
                output += `  Wage at $15/hr: $${wage}\n`;
                output += `  Is this 6.33?: ${Math.round(hours * 100) / 100 === 6.33}\n`;
                output += `  Rounds to $95?: ${Math.round(wage) === 95}\n`;
                output += "\n";
            });
            
            results.innerHTML = `<div class="result">${output}</div>`;
        }
    </script>
</body>
</html>
