<!DOCTYPE html>
<html>
<head>
    <title>Tutorial Test</title>
</head>
<body>
    <h1>Tutorial System Test</h1>
    <p>This page will test if the tutorial system is working properly.</p>
    
    <button id="testRosterTutorial" onclick="testTutorial('roster')">Test Roster Tutorial</button>
    <button id="testLineupTutorial" onclick="testTutorial('lineup')">Test Lineup Tutorial</button>
    
    <div id="testResults"></div>
    
    <script>
        async function testTutorial(tutorialKey) {
            const results = document.getElementById('testResults');
            results.innerHTML = '<p>Testing tutorial: ' + tutorialKey + '</p>';
            
            try {
                // Try to load the main app frame to test
                const iframe = document.createElement('iframe');
                iframe.src = './index.html';
                iframe.style.width = '100%';
                iframe.style.height = '600px';
                iframe.style.border = '1px solid #ccc';
                iframe.onload = function() {
                    try {
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        const tutorialBtn = iframeDoc.querySelector(`.tutorial-btn[data-tutorial-for="${tutorialKey}"]`);
                        
                        if (tutorialBtn) {
                            results.innerHTML += '<p>✓ Found tutorial button for: ' + tutorialKey + '</p>';
                            
                            // Test if global function exists
                            if (iframe.contentWindow.handleStartTutorial) {
                                results.innerHTML += '<p>✓ handleStartTutorial function is available</p>';
                                
                                // Try to start the tutorial
                                iframe.contentWindow.handleStartTutorial(tutorialKey);
                                
                                setTimeout(() => {
                                    const overlay = iframeDoc.getElementById('tutorial-overlay');
                                    if (overlay && overlay.style.display === 'block') {
                                        results.innerHTML += '<p>✓ Tutorial overlay is visible</p>';
                                        results.innerHTML += '<p><strong>SUCCESS: Tutorial system appears to be working!</strong></p>';
                                    } else {
                                        results.innerHTML += '<p>✗ Tutorial overlay is not visible</p>';
                                        results.innerHTML += '<p><strong>ISSUE: Tutorial may not be starting properly</strong></p>';
                                    }
                                }, 1000);
                                
                            } else {
                                results.innerHTML += '<p>✗ handleStartTutorial function not found</p>';
                                results.innerHTML += '<p><strong>ISSUE: Global tutorial function not exposed</strong></p>';
                            }
                        } else {
                            results.innerHTML += '<p>✗ Tutorial button not found for: ' + tutorialKey + '</p>';
                        }
                    } catch (error) {
                        results.innerHTML += '<p>✗ Error accessing iframe content: ' + error.message + '</p>';
                    }
                };
                
                // Replace any existing iframe
                const existing = document.querySelector('iframe');
                if (existing) existing.remove();
                document.body.appendChild(iframe);
                
            } catch (error) {
                results.innerHTML += '<p>✗ Error: ' + error.message + '</p>';
            }
        }
    </script>
</body>
</html>
